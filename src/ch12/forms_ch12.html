<!DOCTYPE html>
<html ng-app="exampleApp">
<head lang="en">
    <meta charset="UTF-8">
    <title>Forms</title>
    <link rel="stylesheet" href="/bootstrap/bootstrap.css"/>
    <link rel="stylesheet" href="/bootstrap/bootstrap-theme.css"/>
    <script src="/angular/angular.js"></script>
    <script>
        angular.module("exampleApp", [])
            .controller("defaultCtrl", function($scope) {
                $scope.todos = [

                    {action: "Get groceries", complete: false},
                    {action: "Call plumber", complete: false},
                    {action: "Buy running shoes", complete: true},
                    {action: "Buy flowers", complete: false},
                    {action: "Call family", complete: false}
                ];
                <!-- exam 12-3 -->
                $scope.addNewItem = function (newItem) {
                    if (angular.isDefined(newItem) && angular.isDefined(newItem.action)
                            && angular.isDefined(newItem.location)) { <!-- exam 12-4 newItem의 폼 유효성-->
                        $scope.todos.push({
                            action: newItem.action + " (" + newItem.location + ")",
                            complete: false
                        });
                    }
                };
                <!-- exam 12-5 기본적인 폼 유효성 체크-->
                $scope.addUser = function(userDetails) {
                    console.log("add user: " + userDetails.name + myFrom.$valid);
                    if(myForm.$valid) {
                        $scope.message = userDetails.name + " (" + userDetails.email + ") (" + userDetails.agreed + ")";
                        console.log("generate message: " + $scope.message);
                    } else {
                        console.log("change validation: ");
                        $scope.showValidation  = true;
                    }
                };

                $scope.message = "Ready";

                <!-- 12-9 유효성 피드백 통합 -->
                $scope.getError = function(error) {
                    if (angular.isDefined( error )) {
                        if (error.required) {
                            return "Please enter a value";
                        } else if (error.email) {
                            return "Please enter a valid email address";
                        }
                    }
                };
            });
    </script>

    <style>
        /* 12-6
        form .ng-invalid-required.ng-dirty { background-color: lightpink; }
        form .ng-invalid-email.ng-dirty { background-color: lightgoldenrodyellow;}
        form .ng-valid.ng-dirty { background-color: lightgreen; }
        span.summary.ng-invalid { color: red; font-weight: bold; }
        span.summary.ng-valid { color: green; }
        */
        /* 12-9 */
        form.validate .ng-invalid-required.ng-dirty { background-color: lightpink; }
        form.validate .ng-invalid-email.ng-dirty { background-color: lightgoldenrodyellow; }
        div.error { color: red; font-weight: bold; }
    </style>

</head>
<body>
<div id="todoPanel" class="panel" ng-controller="defaultCtrl">
    <h3 class="panel-header text-danger">
        To Do List
        <span class="label label-info"> {{(todos | filter: {complete: 'false'}).length}} </span>
    </h3>
    <div class="row">
        <div class="col-xs-6">
            <h4 class="text-success"> # exam.12-3</h4>
            <div class="well">
                <div class="form-group row">
                    <label for="actionText">Acton:</label>
                    <input id="actionText" class="form-control" ng-model="newTodo.action"/>
                </div>
                <div class="form-group row">
                    <label for="actionLocation">Location:</label>
                    <select id="actionLocation" class="form-control" ng-model="newTodo.location">
                        <option >Home</option>
                        <option >Office</option>
                        <option >Mall</option>
                    </select>
                </div>
                <button class="btn btn-primary btn-block" ng-click="addNewItem(newTodo)">Add</button>
            </div>
        </div>
        <div class="col-xs-6">
            <h4 class="text-success"> # exam.12-2</h4>
            <table class="table">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Action</th>
                    <th>Done</th>
                </tr>
                </thead>
                <tbody>

                <tr ng-repeat="item in todos" class="warning">
                    <td>{{$index+1}}</td>
                    <td>{{item.action}}</td>
                    <td>{{item.complete}}</td>
                </tr>
                <td></td><td></td><td></td>
                <tr ng-repeat="item in todos" class="info">
                    <td>{{$index+1}}</td>
                    <td>{{item.action}}</td>
                    <td>
                        <input type="checkbox" ng-model="item.complete"/>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- exam. 12-5 -->
    <!--
    $pristine: 사용자가 엘리먼트/폼을 건드리지 않은 경우 true
    $dirty: 사용자가 엘리먼트/폼과 상호작용한 경우 true
    $valid : 내용이 유호한 경우 true
    $invalid : 내용이 유효하지 않을 경우 true
    $error : 상세 정보 제공
    -->
    <!-- novalidate: 브라우저에서의 검증 중단-->
    <h4 class="text-success"> # exam.12-5,6,7,8</h4>
    <form name="myForm" ng-submit="addUser(newUser)" novalidate ng-class="showValidation ? 'validate': ''">
        <div class="well">
            <div class="form-group">
                <label>Name:</label>
                <input type="text" name="userName" class="form-control" ng-model="newUser.name" required />
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" name="userEmail" class="form-control" ng-model="newUser.email" required />
                <!-- 12-8 -->
                <div class="error" ng-show="showValidation">
                    {{getError(myForm.userEmail.$error)}}
                    <!--
                    <span ng-show="myForm.userEmail.$error.email">Please enter a vaild email address</span>
                    <span ng-show="myForm.userEmail.$error.required">Please enter a value</span>
                    -->
                </div>
            </div>
            <div class="checkbox">
                <label>
                    <input type="checkbox" name="agreed" ng-model="newUser.agreed" required>
                    I agreed to the terms and  conditions
                    </input>
                </label>
            </div>
            <button type="submit" class="btn btn-primary btn-block" ng-disabled="myForm.$invalid">
                OK
            </button>
            <div class="well">
                Message: {{message}}
                <div>
                    Valid:
                    <!-- 12-6 -->
                    <span class="summary" ng-class="myForm.$valid ? 'ng-valid' : 'ng-invalid'">
                        {{myForm.$valid}}
                    </span>
                </div>
            </div>
        </div>
    </form>
</div>
</body>
</html>